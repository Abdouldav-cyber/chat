<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espace Employ√© - Chatbot RH</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a365d;
            --accent: #ed8936;
            --accent-light: #f6ad55;
            --success: #38a169;
            --warning: #d69e2e;
            --danger: #e53e3e;
            --bg-dark: #0f172a;
            --bg-light: #1e293b;
            --bg-card: rgba(255, 255, 255, 0.05);
            --text-light: #e2e8f0;
            --text-muted: #94a3b8;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(180deg, var(--bg-dark) 0%, var(--bg-light) 100%);
            min-height: 100vh;
            color: var(--text-light);
        }

        /* Navigation */
        .navbar {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text-light);
        }

        .nav-brand i {
            font-size: 1.5rem;
            color: var(--accent);
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-link {
            color: var(--text-muted);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--text-light);
            background: rgba(255, 255, 255, 0.1);
        }

        .notification-badge {
            position: relative;
        }

        .notification-badge::after {
            content: attr(data-count);
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
        }

        /* Main container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Section header */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-header h1 {
            font-size: 1.8rem;
            color: var(--accent-light);
        }

        /* Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            margin: 0 auto 15px;
            background: rgba(237, 137, 54, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: var(--accent);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-light);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
        }

        .tab {
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 12px 20px;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            font-family: inherit;
        }

        .tab:hover, .tab.active {
            background: rgba(237, 137, 54, 0.2);
            color: var(--accent-light);
        }

        /* Content panels */
        .panel {
            display: none;
        }

        .panel.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Form */
        .form-card {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-light);
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--text-light);
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(237, 137, 54, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Table */
        .table-container {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px 20px;
            text-align: left;
        }

        th {
            background: rgba(0, 0, 0, 0.2);
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        /* Status badges */
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-pending { background: rgba(214, 158, 46, 0.2); color: var(--warning); }
        .badge-approved { background: rgba(56, 161, 105, 0.2); color: var(--success); }
        .badge-rejected { background: rgba(229, 62, 62, 0.2); color: var(--danger); }

        /* Notifications list */
        .notification-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .notification-item {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px 20px;
            display: flex;
            gap: 15px;
            align-items: flex-start;
            cursor: pointer;
            transition: all 0.3s;
        }

        .notification-item:hover {
            border-color: var(--accent);
        }

        .notification-item.unread {
            background: rgba(237, 137, 54, 0.1);
            border-color: var(--accent);
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .notification-icon.demande { background: rgba(49, 130, 206, 0.2); color: #3182ce; }
        .notification-icon.echeance { background: rgba(214, 158, 46, 0.2); color: var(--warning); }
        .notification-icon.info { background: rgba(56, 161, 105, 0.2); color: var(--success); }

        .notification-content h4 {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .notification-content p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .notification-time {
            color: var(--text-muted);
            font-size: 0.8rem;
            white-space: nowrap;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--accent);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar { flex-direction: column; gap: 15px; }
            .nav-links { flex-wrap: wrap; justify-content: center; }
            .form-row { grid-template-columns: 1fr; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="/" class="nav-brand">
            <i class="fas fa-robot"></i>
            <span>Chatbot RH</span>
        </a>
        <div class="nav-links">
            <a href="/" class="nav-link"><i class="fas fa-home"></i> Accueil</a>
            <a href="/chatbot" class="nav-link"><i class="fas fa-comments"></i> Chatbot</a>
            <a href="/employe" class="nav-link active"><i class="fas fa-user"></i> Mon Espace</a>
            <span class="nav-link notification-badge" data-count="0" onclick="showPanel('notifications')">
                <i class="fas fa-bell"></i>
            </span>
            <a href="#" class="nav-link" onclick="logout()" style="color: #e53e3e;">
                <i class="fas fa-sign-out-alt"></i> D√©connexion
            </a>
        </div>
    </nav>

    <div class="container">
        <div class="section-header">
            <h1>üë§ Mon Espace Employ√©</h1>
            <button class="btn btn-primary" onclick="showPanel('nouvelle-demande')">
                <i class="fas fa-plus"></i> Nouvelle demande
            </button>
        </div>

        <!-- Stats cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-calendar"></i></div>
                <div class="stat-value" id="soldeConges">--</div>
                <div class="stat-label">Jours de cong√©s restants</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-clock"></i></div>
                <div class="stat-value" id="demandesEnAttente">0</div>
                <div class="stat-label">Demandes en attente</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                <div class="stat-value" id="demandesApprouvees">0</div>
                <div class="stat-label">Demandes approuv√©es</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-bell"></i></div>
                <div class="stat-value" id="notificationsCount">0</div>
                <div class="stat-label">Notifications non lues</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showPanel('mes-demandes')">
                <i class="fas fa-list"></i> Mes demandes
            </button>
            <button class="tab" onclick="showPanel('nouvelle-demande')">
                <i class="fas fa-plus-circle"></i> Nouvelle demande
            </button>
            <button class="tab" onclick="showPanel('notifications')">
                <i class="fas fa-bell"></i> Notifications
            </button>
            <button class="tab" onclick="showPanel('avantages')">
                <i class="fas fa-gift"></i> Mes avantages
            </button>
        </div>

        <!-- Panel: Mes demandes -->
        <div class="panel active" id="panel-mes-demandes">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Dates</th>
                            <th>Dur√©e</th>
                            <th>Statut</th>
                            <th>Date demande</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="demandesTable">
                        <!-- Donn√©es charg√©es dynamiquement -->
                    </tbody>
                </table>
            </div>
            <div class="empty-state" id="emptyDemandes" style="display: none;">
                <i class="fas fa-folder-open"></i>
                <h3>Aucune demande</h3>
                <p>Vous n'avez pas encore fait de demande. Cliquez sur "Nouvelle demande" pour commencer.</p>
            </div>
        </div>

        <!-- Panel: Nouvelle demande -->
        <div class="panel" id="panel-nouvelle-demande">
            <div class="form-card">
                <h2 style="margin-bottom: 25px; color: var(--accent-light);">üìù Nouvelle demande</h2>
                <form id="demandeForm" onsubmit="submitDemande(event)">
                    <div class="form-group">
                        <label class="form-label">Type de demande</label>
                        <select class="form-control" id="typeDemande" required onchange="updateFormFields()">
                            <option value="">S√©lectionnez...</option>
                            <option value="conge">üèñÔ∏è Cong√©</option>
                            <option value="remboursement">üí∞ Remboursement</option>
                            <option value="attestation">üìÑ Attestation</option>
                        </select>
                    </div>

                    <div id="sousTypeGroup" class="form-group" style="display: none;">
                        <label class="form-label">Sous-type</label>
                        <select class="form-control" id="sousType">
                            <!-- Options dynamiques -->
                        </select>
                    </div>

                    <div id="datesGroup" class="form-row" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Date de d√©but</label>
                            <input type="date" class="form-control" id="dateDebut">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Date de fin</label>
                            <input type="date" class="form-control" id="dateFin">
                        </div>
                    </div>

                    <div id="montantGroup" class="form-group" style="display: none;">
                        <label class="form-label">Montant (‚Ç¨)</label>
                        <input type="number" class="form-control" id="montant" step="0.01" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Motif / Commentaire</label>
                        <textarea class="form-control" id="motif" rows="3" placeholder="Pr√©cisez le motif de votre demande..."></textarea>
                    </div>

                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Soumettre
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="showPanel('mes-demandes')">
                            Annuler
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Panel: Notifications -->
        <div class="panel" id="panel-notifications">
            <div class="notification-list" id="notificationsList">
                <!-- Notifications charg√©es dynamiquement -->
            </div>
            <div class="empty-state" id="emptyNotifications" style="display: none;">
                <i class="fas fa-bell-slash"></i>
                <h3>Aucune notification</h3>
                <p>Vous √™tes √† jour ! Aucune notification pour le moment.</p>
            </div>
        </div>

        <!-- Panel: Avantages -->
        <div class="panel" id="panel-avantages">
            <div class="stats-grid" id="avantagesList">
                <!-- Avantages charg√©s dynamiquement -->
            </div>
        </div>
    </div>

    <script>
        // Employ√© ID r√©cup√©r√© depuis la session
        let employeId = null;
        let currentUser = null;

        // V√©rifier l'authentification au chargement
        async function checkAuth() {
            try {
                const response = await fetch('/api/auth/me');
                const data = await response.json();
                
                if (!data.authenticated) {
                    window.location.href = '/login';
                    return;
                }
                
                currentUser = data.user;
                employeId = data.user.id;
                
                // Afficher le nom de l'utilisateur
                document.querySelector('.section-header h1').innerHTML = 
                    `üë§ Bienvenue, ${currentUser.prenom} !`;
                
            } catch (error) {
                window.location.href = '/login';
            }
        }

        async function logout() {
            try {
                await fetch('/api/auth/logout', { method: 'POST' });
                window.location.href = '/login';
            } catch (error) {
                window.location.href = '/login';
            }
        }

        function showPanel(panelId) {
            // Masquer tous les panels
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            // Afficher le panel s√©lectionn√©
            document.getElementById('panel-' + panelId).classList.add('active');
            
            // Activer l'onglet correspondant
            document.querySelectorAll('.tab').forEach(t => {
                if (t.textContent.toLowerCase().includes(panelId.split('-')[0])) {
                    t.classList.add('active');
                }
            });
        }

        function updateFormFields() {
            const type = document.getElementById('typeDemande').value;
            const sousTypeGroup = document.getElementById('sousTypeGroup');
            const datesGroup = document.getElementById('datesGroup');
            const montantGroup = document.getElementById('montantGroup');
            const sousType = document.getElementById('sousType');

            sousTypeGroup.style.display = 'none';
            datesGroup.style.display = 'none';
            montantGroup.style.display = 'none';

            if (type === 'conge') {
                sousTypeGroup.style.display = 'block';
                datesGroup.style.display = 'grid';
                sousType.innerHTML = `
                    <option value="conge_annuel">Cong√© annuel</option>
                    <option value="conge_maladie">Cong√© maladie</option>
                    <option value="conge_exceptionnel">Cong√© exceptionnel</option>
                    <option value="conge_sans_solde">Cong√© sans solde</option>
                `;
            } else if (type === 'remboursement') {
                sousTypeGroup.style.display = 'block';
                montantGroup.style.display = 'block';
                sousType.innerHTML = `
                    <option value="transport">Transport</option>
                    <option value="frais_pro">Frais professionnels</option>
                    <option value="formation">Formation</option>
                `;
            } else if (type === 'attestation') {
                sousTypeGroup.style.display = 'block';
                sousType.innerHTML = `
                    <option value="attestation_travail">Attestation de travail</option>
                    <option value="attestation_salaire">Attestation de salaire</option>
                `;
            }
        }

        async function submitDemande(event) {
            event.preventDefault();
            
            const data = {
                employe_id: employeId,
                type_demande: document.getElementById('typeDemande').value,
                sous_type: document.getElementById('sousType').value,
                date_debut: document.getElementById('dateDebut').value || null,
                date_fin: document.getElementById('dateFin').value || null,
                montant: document.getElementById('montant').value || null,
                motif: document.getElementById('motif').value
            };

            try {
                const response = await fetch('/api/demandes', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ Demande soumise avec succ√®s !');
                    document.getElementById('demandeForm').reset();
                    loadDemandes();
                    showPanel('mes-demandes');
                } else {
                    alert('‚ùå Erreur: ' + result.error);
                }
            } catch (error) {
                alert('‚ùå Erreur de connexion');
                console.error(error);
            }
        }

        async function loadDemandes() {
            try {
                const response = await fetch(`/api/demandes?employe_id=${employeId}`);
                const data = await response.json();
                
                const tbody = document.getElementById('demandesTable');
                const empty = document.getElementById('emptyDemandes');
                
                if (data.demandes && data.demandes.length > 0) {
                    empty.style.display = 'none';
                    tbody.innerHTML = data.demandes.map(d => `
                        <tr>
                            <td>${d.type_demande} ${d.sous_type ? `(${d.sous_type})` : ''}</td>
                            <td>${d.date_debut ? d.date_debut.split('T')[0] : '-'} ${d.date_fin ? '‚Üí ' + d.date_fin.split('T')[0] : ''}</td>
                            <td>${d.nb_jours ? d.nb_jours + ' jours' : (d.montant ? d.montant + ' ‚Ç¨' : '-')}</td>
                            <td><span class="badge badge-${getStatusClass(d.statut)}">${d.statut}</span></td>
                            <td>${new Date(d.created_at).toLocaleDateString('fr-FR')}</td>
                            <td>
                                ${d.statut === 'en_attente' ? `<button class="btn btn-secondary" onclick="annulerDemande(${d.id})"><i class="fas fa-times"></i></button>` : ''}
                            </td>
                        </tr>
                    `).join('');

                    // Stats
                    document.getElementById('demandesEnAttente').textContent = 
                        data.demandes.filter(d => d.statut === 'en_attente').length;
                    document.getElementById('demandesApprouvees').textContent = 
                        data.demandes.filter(d => d.statut === 'approuve').length;
                } else {
                    tbody.innerHTML = '';
                    empty.style.display = 'block';
                }
            } catch (error) {
                console.error('Erreur chargement demandes:', error);
            }
        }

        function getStatusClass(status) {
            switch(status) {
                case 'en_attente': return 'pending';
                case 'approuve': return 'approved';
                case 'refuse': return 'rejected';
                default: return 'pending';
            }
        }

        async function annulerDemande(demandeId) {
            if (!confirm('Voulez-vous vraiment annuler cette demande ?')) return;
            
            try {
                const response = await fetch('/api/demandes/annuler', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ demande_id: demandeId, employe_id: employeId })
                });
                
                const result = await response.json();
                if (result.success) {
                    loadDemandes();
                } else {
                    alert('Erreur: ' + result.error);
                }
            } catch (error) {
                console.error(error);
            }
        }

        async function loadNotifications() {
            try {
                const response = await fetch(`/api/notifications?employe_id=${employeId}`);
                const data = await response.json();
                
                const list = document.getElementById('notificationsList');
                const empty = document.getElementById('emptyNotifications');
                
                document.getElementById('notificationsCount').textContent = data.non_lues_count || 0;
                document.querySelector('.notification-badge').setAttribute('data-count', data.non_lues_count || 0);
                
                if (data.notifications && data.notifications.length > 0) {
                    empty.style.display = 'none';
                    list.innerHTML = data.notifications.map(n => `
                        <div class="notification-item ${n.lue ? '' : 'unread'}" onclick="markAsRead(${n.id})">
                            <div class="notification-icon ${n.type_notification}">
                                <i class="fas fa-${getNotificationIcon(n.type_notification)}"></i>
                            </div>
                            <div class="notification-content">
                                <h4>${n.titre}</h4>
                                <p>${n.message}</p>
                            </div>
                            <span class="notification-time">${formatDate(n.created_at)}</span>
                        </div>
                    `).join('');
                } else {
                    list.innerHTML = '';
                    empty.style.display = 'block';
                }
            } catch (error) {
                console.error('Erreur chargement notifications:', error);
            }
        }

        function getNotificationIcon(type) {
            switch(type) {
                case 'demande': return 'file-alt';
                case 'echeance': return 'clock';
                default: return 'info-circle';
            }
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 3600000) return Math.floor(diff / 60000) + ' min';
            if (diff < 86400000) return Math.floor(diff / 3600000) + ' h';
            return date.toLocaleDateString('fr-FR');
        }

        async function markAsRead(notificationId) {
            try {
                await fetch('/api/notifications/lue', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ notification_id: notificationId, employe_id: employeId })
                });
                loadNotifications();
            } catch (error) {
                console.error(error);
            }
        }

        async function loadAvantages() {
            try {
                const response = await fetch('/api/avantages');
                const data = await response.json();
                
                const list = document.getElementById('avantagesList');
                
                if (data.avantages && data.avantages.length > 0) {
                    list.innerHTML = data.avantages.map(a => `
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-${getCategorieIcon(a.categorie)}"></i>
                            </div>
                            <div class="stat-value" style="font-size: 1.2rem;">${a.nom}</div>
                            <div class="stat-label">${a.description || ''}</div>
                            <div style="margin-top: 10px; color: var(--success); font-weight: 500;">
                                ${a.montant_ou_taux || ''}
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Erreur chargement avantages:', error);
            }
        }

        function getCategorieIcon(categorie) {
            switch(categorie) {
                case 'sante': return 'heart';
                case 'transport': return 'bus';
                case 'restauration': return 'utensils';
                case 'formation': return 'graduation-cap';
                default: return 'gift';
            }
        }

        async function loadProfil() {
            try {
                const response = await fetch(`/api/employe/profil?employe_id=${employeId}`);
                const data = await response.json();
                
                if (data.solde_conges !== undefined) {
                    document.getElementById('soldeConges').textContent = data.solde_conges;
                }
            } catch (error) {
                console.error('Erreur chargement profil:', error);
            }
        }

        // Chargement initial
        document.addEventListener('DOMContentLoaded', async () => {
            await checkAuth();
            if (employeId) {
                loadProfil();
                loadDemandes();
                loadNotifications();
                loadAvantages();
            }
        });
    </script>
</body>
</html>

